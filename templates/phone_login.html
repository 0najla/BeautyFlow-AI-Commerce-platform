<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Phone Login</title>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/B.png') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style2.css') }}">
</head>

<body class="login-page phone-page">
  <main class="login-card phone-card" style="max-width:560px">
    <h1 class="title">Enter Phone Number</h1>
    <label class="field-label" for="phone">Mobile Number</label>

    <!-- ðŸ“± Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… -->
    <form class="phone-form" action="{{ url_for('send_otp') }}" method="post" onsubmit="return validatePhone()">
      <input type="hidden" name="country" id="countryHidden" value="SA">
      <input type="hidden" name="cc" id="ccHidden" value="+966">

      <div class="phone-input" id="phoneInput">
        <div class="flag">
          <img id="flagImg" src="{{ url_for('static', filename='images/ksa.png') }}" alt="Saudi flag">
        </div>

        <button type="button" class="country" id="countryBtn" aria-haspopup="listbox" aria-expanded="false">
          <span id="countryCode">SA</span>
          <span class="caret"></span>
        </button>

        <div class="cc" id="ccText">+966</div>
        <div class="sep"></div>

        <input id="phone" name="phone" type="tel" inputmode="numeric" placeholder="500000000" required>
      </div>

      <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙˆÙ‚ Ø§Ù„Ø²Ø± -->
      <p id="errorMsg" class="fade-message">Enter the number correctly</p>

      <button type="submit" class="send-btn">Send Verification Code</button>
    </form>


    <!-- ðŸ”½ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆÙ„Ø© -->
    <ul class="country-dropdown" id="countryDropdown" role="listbox">
      <li data-country="SA" data-cc="+966" data-flag="{{ url_for('static', filename='images/ksa.png') }}" role="option"
        aria-selected="true">
        <img src="{{ url_for('static', filename='images/ksa.png') }}" alt=""> Saudi Arabia (+966)
      </li>
    </ul>
    </div>



  </main>
  <style>
    .fade-message {
      color: #e25b7f;
      font-size: 14px;
      text-align: center;
      margin: 10px 0 0 0;
      display: none;
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .fade-message.show {
      display: block;
      opacity: 1;
    }

    .send-btn {
      background-color: #f7c9d4;
      color: #000;
      border: none;
      border-radius: 25px;
      padding: 12px 24px;
      font-weight: 600;
      margin-top: 15px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .send-btn:hover {
      background-color: #f4a9bd;
    }
  </style>

  <script>
    // ðŸŒ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ø¯ÙˆÙ„
    document.addEventListener("DOMContentLoaded", function () {
      const btn = document.getElementById("countryBtn");
      const dd = document.getElementById("countryDropdown");
      const flagImg = document.getElementById("flagImg");
      const ccText = document.getElementById("ccText");
      const codeEl = document.getElementById("countryCode");
      const hiddenCountry = document.getElementById("countryHidden");
      const hiddenCc = document.getElementById("ccHidden");

      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        dd.classList.toggle("show");
        btn.setAttribute("aria-expanded", dd.classList.contains("show") ? "true" : "false");
      });

      dd.querySelectorAll("li").forEach(li => {
        li.addEventListener("click", () => {
          const country = li.dataset.country;
          const cc = li.dataset.cc;
          const flag = li.dataset.flag;

          flagImg.src = flag;
          ccText.textContent = cc;
          codeEl.textContent = country;
          hiddenCountry.value = country;
          hiddenCc.value = cc;

          dd.querySelectorAll("li").forEach(x => x.removeAttribute("aria-selected"));
          li.setAttribute("aria-selected", "true");
          dd.classList.remove("show");
          btn.setAttribute("aria-expanded", "false");
        });
      });

      document.addEventListener("click", (e) => {
        if (!dd.contains(e.target) && !btn.contains(e.target)) dd.classList.remove("show");
      });
    });
    function validatePhone() {
      const phone = document.getElementById("phone").value.trim();
      const errorMsg = document.getElementById("errorMsg");
      const pattern = /^5\d{8}$/; // ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 5 ÙˆÙŠØªØ¨Ø¹Ù‡ 8 Ø£Ø±Ù‚Ø§Ù… = 9 Ø£Ø±Ù‚Ø§Ù… Ø¨Ø§Ù„Ø¶Ø¨Ø·

      if (!pattern.test(phone)) {
        errorMsg.classList.add("show");
        return false;
      } else {
        errorMsg.classList.remove("show");
        return true;
      }
    }
  </script>
</body>

</html>