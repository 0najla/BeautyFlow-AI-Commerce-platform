<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <!-- ====================================================================
     BeautyFlow - Reset Password Page
     ====================================================================
     Step 3 of password recovery flow. User creates new password after
     OTP verification. Auto-login to home page after successful reset.

     Author: BeautyFlow Team
     Version: 1.0.0
     ==================================================================== -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='white' rx='15' width='100' height='100'/%3E%3Ctext x='50' y='68' font-size='45' font-weight='bold' fill='%23e84a8a' text-anchor='middle'%3EBF%3C/text%3E%3C/svg%3E">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BeautyFlow - Reset Password</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --pink-primary: #ff8fab;
            --pink-light: #ffc2d1;
            --pink-dark: #fb6f92;
            --pink-deep: #e75480;
            --cream: #fff5f7;
            --cream-dark: #ffe5ec;
            --charcoal: #4a4a4a;
            --charcoal-light: #6b6b6b;
            --blush: #ffecf1;
            --pearl: #fffbfc;
            --glass-border: rgba(255, 182, 193, 0.3);
            --success-green: #10b981;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            min-height: 100vh;
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
            background: linear-gradient(135deg, #ffe5ec 0%, #ffc2d1 50%, #ffb3c6 100%);
        }

        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; overflow: hidden; }
        .floating-orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.5; animation: float 20s ease-in-out infinite; }
        .orb-1 { width: 600px; height: 600px; background: radial-gradient(circle, #ff8fab 0%, transparent 70%); top: -200px; left: -200px; }
        .orb-2 { width: 500px; height: 500px; background: radial-gradient(circle, #ffc2d1 0%, transparent 70%); bottom: -150px; right: -150px; animation-delay: -5s; }
        .orb-3 { width: 400px; height: 400px; background: radial-gradient(circle, #ffb3c6 0%, transparent 70%); top: 50%; left: 50%; transform: translate(-50%, -50%); animation-delay: -10s; opacity: 0.3; }
        @keyframes float { 0%, 100% { transform: translate(0, 0) scale(1); } 25% { transform: translate(50px, -50px) scale(1.1); } 50% { transform: translate(-30px, 30px) scale(0.95); } 75% { transform: translate(40px, 40px) scale(1.05); } }
        .sparkles { position: absolute; width: 100%; height: 100%; pointer-events: none; }
        .sparkle { position: absolute; width: 4px; height: 4px; background: rgba(255, 255, 255, 0.8); border-radius: 50%; animation: sparkle 3s ease-in-out infinite; box-shadow: 0 0 6px rgba(255, 143, 171, 0.5); }
        @keyframes sparkle { 0%, 100% { opacity: 0; transform: scale(0); } 50% { opacity: 1; transform: scale(1); } }

        .reset-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; position: relative; z-index: 1; }
        .reset-wrapper { display: flex; width: 100%; max-width: 1100px; min-height: 650px; border-radius: 32px; overflow: hidden; box-shadow: 0 50px 100px rgba(0, 0, 0, 0.5), 0 0 0 1px var(--glass-border); animation: cardAppear 1s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; transform: translateY(40px); }
        @keyframes cardAppear { to { opacity: 1; transform: translateY(0); } }

        .brand-panel { flex: 1; background: linear-gradient(160deg, #ff8fab 0%, #fb6f92 100%); padding: 60px 50px; display: flex; flex-direction: column; justify-content: space-between; position: relative; overflow: hidden; }
        .brand-panel::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); opacity: 0.5; }
        .brand-content { position: relative; z-index: 1; }
        .brand-logo { display: flex; align-items: center; gap: 16px; margin-bottom: 60px; animation: slideIn 0.8s ease-out 0.2s both; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
        .logo-mark { width: 56px; height: 56px; background: linear-gradient(135deg, #ffffff 0%, #fff5f7 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-family: 'Cormorant Garamond', serif; font-size: 28px; font-weight: 700; color: var(--pink-dark); box-shadow: 0 8px 32px rgba(251, 111, 146, 0.4); position: relative; overflow: hidden; }
        .logo-mark::after { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.6) 50%, transparent 60%); animation: shimmer 3s ease-in-out infinite; }
        @keyframes shimmer { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }
        .logo-text { font-family: 'Cormorant Garamond', serif; font-size: 28px; font-weight: 600; color: var(--cream); letter-spacing: 2px; }
        .brand-headline { animation: slideIn 0.8s ease-out 0.4s both; }
        .brand-headline h1 { font-family: 'Cormorant Garamond', serif; font-size: 48px; font-weight: 600; color: var(--cream); line-height: 1.2; margin-bottom: 20px; }
        .brand-headline h1 span { color: #fff5f7; text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3); }
        .brand-headline p { font-size: 16px; color: rgba(255, 255, 255, 0.6); line-height: 1.8; max-width: 380px; }
        .progress-steps { display: flex; flex-direction: column; gap: 16px; margin-top: 50px; animation: slideIn 0.8s ease-out 0.6s both; }
        .step-item { display: flex; align-items: center; gap: 16px; padding: 16px 20px; background: rgba(255, 255, 255, 0.15); border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.2); }
        .step-item.completed { background: rgba(255, 255, 255, 0.25); border-color: rgba(255, 255, 255, 0.4); }
        .step-item.active { background: rgba(255, 255, 255, 0.3); border-color: #fff; transform: translateX(8px); }
        .step-number { width: 36px; height: 36px; background: rgba(255, 255, 255, 0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; color: white; }
        .step-item.completed .step-number { background: white; color: var(--pink-dark); }
        .step-item.active .step-number { background: white; color: var(--pink-dark); animation: pulse 2s ease-in-out infinite; }
        @keyframes pulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.5); } 50% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); } }
        .step-text h4 { color: var(--cream); font-size: 14px; font-weight: 500; }
        .step-text p { color: rgba(255, 255, 255, 0.5); font-size: 12px; }
        .brand-footer { position: relative; z-index: 1; }
        .brand-footer p { color: rgba(255, 255, 255, 0.4); font-size: 12px; }

        .form-panel { flex: 1; background: var(--cream); padding: 60px 50px; display: flex; flex-direction: column; justify-content: center; position: relative; }
        .form-panel::before { content: ''; position: absolute; top: 40px; right: 40px; width: 120px; height: 120px; background: radial-gradient(circle, var(--blush) 0%, transparent 70%); border-radius: 50%; filter: blur(40px); }
        .form-header { margin-bottom: 40px; animation: slideUp 0.8s ease-out 0.3s both; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .form-header .icon-wrapper { width: 80px; height: 80px; background: linear-gradient(135deg, var(--pink-light) 0%, var(--pink-primary) 100%); border-radius: 24px; display: flex; align-items: center; justify-content: center; margin-bottom: 24px; box-shadow: 0 8px 32px rgba(255, 143, 171, 0.3); }
        .form-header .icon-wrapper svg { width: 40px; height: 40px; color: white; }
        .form-header h2 { font-family: 'Cormorant Garamond', serif; font-size: 36px; font-weight: 600; color: var(--charcoal); margin-bottom: 8px; }
        .form-header p { color: var(--charcoal-light); font-size: 14px; line-height: 1.6; }
        .reset-form { display: flex; flex-direction: column; gap: 24px; animation: slideUp 0.8s ease-out 0.5s both; }
        .input-group { position: relative; }
        .input-group label { display: block; font-size: 12px; font-weight: 500; color: var(--charcoal-light); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .input-wrapper { position: relative; display: flex; align-items: center; }
        .input-icon { position: absolute; left: 20px; color: var(--pink-primary); pointer-events: none; transition: all 0.3s ease; }
        .input-wrapper input { width: 100%; padding: 18px 54px 18px 54px; font-family: 'Montserrat', sans-serif; font-size: 15px; color: var(--charcoal); background: var(--pearl); border: 2px solid transparent; border-radius: 16px; outline: none; transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: 0 2px 8px rgba(255, 143, 171, 0.1); }
        .input-wrapper input::placeholder { color: #ccc; }
        .input-wrapper input:hover { background: white; box-shadow: 0 4px 16px rgba(255, 143, 171, 0.15); }
        .input-wrapper input:focus { background: white; border-color: var(--pink-primary); box-shadow: 0 8px 24px rgba(255, 143, 171, 0.2), 0 0 0 4px rgba(255, 143, 171, 0.15); }
        .toggle-password { position: absolute; right: 20px; background: none; border: none; color: var(--charcoal-light); cursor: pointer; padding: 4px; opacity: 0.6; transition: all 0.3s ease; }
        .toggle-password:hover { opacity: 1; color: var(--pink-primary); }
        .password-strength { margin-top: 12px; }
        .strength-bar { height: 4px; background: #e0e0e0; border-radius: 4px; overflow: hidden; margin-bottom: 8px; }
        .strength-fill { height: 100%; width: 0%; border-radius: 4px; transition: all 0.3s ease; }
        .strength-fill.weak { width: 25%; background: #f87171; }
        .strength-fill.fair { width: 50%; background: #fbbf24; }
        .strength-fill.good { width: 75%; background: #60a5fa; }
        .strength-fill.strong { width: 100%; background: #34d399; }
        .strength-text { font-size: 12px; color: var(--charcoal-light); }
        .strength-text.weak { color: #f87171; }
        .strength-text.fair { color: #fbbf24; }
        .strength-text.good { color: #60a5fa; }
        .strength-text.strong { color: #34d399; }
        .password-requirements { background: var(--blush); border-radius: 12px; padding: 16px; margin-top: 8px; }
        .password-requirements h4 { font-size: 12px; font-weight: 600; color: var(--charcoal); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .requirement { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--charcoal-light); margin-bottom: 6px; }
        .requirement:last-child { margin-bottom: 0; }
        .requirement-icon { width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; background: #e0e0e0; color: #999; transition: all 0.3s ease; }
        .requirement.met .requirement-icon { background: var(--success-green); color: white; }
        .requirement.met { color: var(--success-green); }
        .error-message { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border: 1px solid #f87171; border-radius: 12px; padding: 14px 18px; color: #dc2626; font-size: 13px; display: flex; align-items: center; gap: 10px; animation: shake 0.5s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 20%, 60% { transform: translateX(-8px); } 40%, 80% { transform: translateX(8px); } }
        .btn-submit { position: relative; padding: 18px 32px; font-family: 'Montserrat', sans-serif; font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 2px; color: white; background: linear-gradient(135deg, var(--pink-primary) 0%, var(--pink-dark) 100%); border: none; border-radius: 16px; cursor: pointer; overflow: hidden; transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: 0 8px 24px rgba(255, 143, 171, 0.4); margin-top: 8px; }
        .btn-submit::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, var(--pink-dark) 0%, var(--pink-deep) 100%); opacity: 0; transition: opacity 0.4s ease; }
        .btn-submit:hover { transform: translateY(-3px); box-shadow: 0 12px 32px rgba(255, 143, 171, 0.5); }
        .btn-submit:hover::before { opacity: 1; }
        .btn-submit:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .btn-submit span { position: relative; z-index: 1; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-submit .spinner { position: absolute; width: 24px; height: 24px; border: 3px solid rgba(255, 255, 255, 0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; opacity: 0; }
        .btn-submit.loading span { opacity: 0; }
        .btn-submit.loading .spinner { opacity: 1; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .input-wrapper.valid input { border-color: var(--success-green); }
        .input-wrapper.invalid input { border-color: #f87171; }
        .match-indicator { position: absolute; right: 52px; font-size: 14px; opacity: 0; transition: all 0.3s ease; }
        .match-indicator.show { opacity: 1; }
        .match-indicator.match { color: var(--success-green); }
        .match-indicator.no-match { color: #f87171; }

        @media (max-width: 900px) {
            .reset-wrapper { flex-direction: column; max-width: 500px; }
            .brand-panel { padding: 40px 30px; }
            .brand-headline h1 { font-size: 36px; }
            .progress-steps { display: none; }
            .form-panel { padding: 40px 30px; }
            .form-header h2 { font-size: 28px; }
        }
        @media (max-width: 480px) {
            .reset-container { padding: 16px; }
            .reset-wrapper { border-radius: 24px; }
            .brand-panel { padding: 30px 24px; }
            .form-panel { padding: 30px 24px; }
            .form-header h2 { font-size: 24px; }
            .input-wrapper input { padding: 16px 48px; font-size: 14px; }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <div class="floating-orb orb-1"></div>
        <div class="floating-orb orb-2"></div>
        <div class="floating-orb orb-3"></div>
        <div class="sparkles" id="sparkles"></div>
    </div>

    <div class="reset-container">
        <div class="reset-wrapper">
            <div class="brand-panel">
                <div class="brand-content">
                    <div class="brand-logo">
                        <div class="logo-mark">BF</div>
                        <div class="logo-text">BeautyFlow</div>
                    </div>
                    <div class="brand-headline">
                        <h1>Create New <br><span>Password</span></h1>
                        <p>You're almost done! Create a strong password to secure your account. Make sure it's unique and memorable.</p>
                    </div>
                    <div class="progress-steps">
                        <div class="step-item completed">
                            <div class="step-number">✓</div>
                            <div class="step-text"><h4>Enter Email</h4><p>Email verified</p></div>
                        </div>
                        <div class="step-item completed">
                            <div class="step-number">✓</div>
                            <div class="step-text"><h4>Verify OTP</h4><p>Phone verified</p></div>
                        </div>
                        <div class="step-item active">
                            <div class="step-number">3</div>
                            <div class="step-text"><h4>Reset Password</h4><p>Create your new password</p></div>
                        </div>
                    </div>
                </div>
                <div class="brand-footer"><p>© 2025 BeautyFlow • BeautyFlow Project</p></div>
            </div>

            <div class="form-panel">
                <div class="form-header">
                    <div class="icon-wrapper">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                    </div>
                    <h2>Create New Password</h2>
                    <p>Your new password must be different from previously used passwords.</p>
                </div>

                <form id="resetForm" class="reset-form" method="POST" action="{{ url_for('reset_password_submit') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    
                    <div class="input-group">
                        <label for="password">New Password</label>
                        <div class="input-wrapper" id="password-wrapper">
                            <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                            <input type="password" name="password" id="password" placeholder="Enter new password" required autocomplete="new-password">
                            <button type="button" class="toggle-password" data-target="password">
                                <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                                <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                            </button>
                        </div>
                        <div class="password-strength">
                            <div class="strength-bar"><div class="strength-fill" id="strengthFill"></div></div>
                            <span class="strength-text" id="strengthText">Password strength</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="confirm_password">Confirm New Password</label>
                        <div class="input-wrapper" id="confirm-wrapper">
                            <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                            <input type="password" name="confirm_password" id="confirm_password" placeholder="Confirm new password" required autocomplete="new-password">
                            <span class="match-indicator" id="matchIndicator"></span>
                            <button type="button" class="toggle-password" data-target="confirm_password">
                                <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                                <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                            </button>
                        </div>
                    </div>

                    <div class="password-requirements">
                        <h4>Password must contain:</h4>
                        <div class="requirement" id="req-length"><span class="requirement-icon">✓</span><span>At least 6 characters</span></div>
                        <div class="requirement" id="req-upper"><span class="requirement-icon">✓</span><span>One uppercase letter (A-Z)</span></div>
                        <div class="requirement" id="req-lower"><span class="requirement-icon">✓</span><span>One lowercase letter (a-z)</span></div>
                        <div class="requirement" id="req-number"><span class="requirement-icon">✓</span><span>One number (0-9)</span></div>
                    </div>

                    {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}{% for category, message in messages %}{% if category == 'error' %}
                    <div class="error-message"><span>⚠️</span> {{ message }}</div>
                    {% endif %}{% endfor %}{% endif %}{% endwith %}

                    <button type="submit" class="btn-submit" id="submitBtn" disabled>
                        <span>Reset Password <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg></span>
                        <div class="spinner"></div>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        function createSparkles() {
            const container = document.getElementById('sparkles');
            if (!container) return;
            for (let i = 0; i < 50; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 3 + 's';
                sparkle.style.animationDuration = (2 + Math.random() * 2) + 's';
                container.appendChild(sparkle);
            }
        }
        createSparkles();

        document.querySelectorAll('.toggle-password').forEach(btn => {
            btn.addEventListener('click', function() {
                const targetId = this.dataset.target;
                const input = document.getElementById(targetId);
                const type = input.type === 'password' ? 'text' : 'password';
                input.type = type;
                const eyeOpen = this.querySelector('.eye-open');
                const eyeClosed = this.querySelector('.eye-closed');
                if (type === 'text') { eyeOpen.style.display = 'none'; eyeClosed.style.display = 'block'; }
                else { eyeOpen.style.display = 'block'; eyeClosed.style.display = 'none'; }
            });
        });

        const passwordInput = document.getElementById('password');
        const confirmInput = document.getElementById('confirm_password');
        const submitBtn = document.getElementById('submitBtn');
        const strengthFill = document.getElementById('strengthFill');
        const strengthText = document.getElementById('strengthText');
        const matchIndicator = document.getElementById('matchIndicator');

        const requirements = {
            length: { el: document.getElementById('req-length'), check: p => p.length >= 6 },
            upper: { el: document.getElementById('req-upper'), check: p => /[A-Z]/.test(p) },
            lower: { el: document.getElementById('req-lower'), check: p => /[a-z]/.test(p) },
            number: { el: document.getElementById('req-number'), check: p => /[0-9]/.test(p) }
        };

        function checkPasswordStrength(password) {
            let metCount = 0;
            Object.keys(requirements).forEach(key => {
                const req = requirements[key];
                const met = req.check(password);
                if (met) { req.el.classList.add('met'); metCount++; }
                else { req.el.classList.remove('met'); }
            });

            if (metCount === 1) { strengthFill.className = 'strength-fill weak'; strengthText.className = 'strength-text weak'; strengthText.textContent = 'Weak'; }
            else if (metCount === 2) { strengthFill.className = 'strength-fill fair'; strengthText.className = 'strength-text fair'; strengthText.textContent = 'Fair'; }
            else if (metCount === 3) { strengthFill.className = 'strength-fill good'; strengthText.className = 'strength-text good'; strengthText.textContent = 'Good'; }
            else if (metCount === 4) { strengthFill.className = 'strength-fill strong'; strengthText.className = 'strength-text strong'; strengthText.textContent = 'Strong'; }
            else { strengthFill.className = 'strength-fill'; strengthText.className = 'strength-text'; strengthText.textContent = 'Password strength'; }
            return metCount === 4;
        }

        function checkPasswordMatch() {
            const password = passwordInput.value;
            const confirm = confirmInput.value;
            if (confirm.length === 0) { matchIndicator.classList.remove('show'); return false; }
            matchIndicator.classList.add('show');
            if (password === confirm) {
                matchIndicator.textContent = '✓'; matchIndicator.classList.remove('no-match'); matchIndicator.classList.add('match');
                document.getElementById('confirm-wrapper').classList.remove('invalid'); document.getElementById('confirm-wrapper').classList.add('valid');
                return true;
            } else {
                matchIndicator.textContent = '✗'; matchIndicator.classList.remove('match'); matchIndicator.classList.add('no-match');
                document.getElementById('confirm-wrapper').classList.remove('valid'); document.getElementById('confirm-wrapper').classList.add('invalid');
                return false;
            }
        }

        function validateForm() {
            const passwordValid = checkPasswordStrength(passwordInput.value);
            const passwordsMatch = checkPasswordMatch();
            submitBtn.disabled = !(passwordValid && passwordsMatch);
        }

        passwordInput.addEventListener('input', validateForm);
        confirmInput.addEventListener('input', validateForm);

        document.getElementById('resetForm').addEventListener('submit', function(e) {
            if (submitBtn.disabled) { e.preventDefault(); return; }
            submitBtn.classList.add('loading');
        });

        window.addEventListener('load', () => { setTimeout(() => passwordInput.focus(), 1200); });
    </script>
</body>
</html>